# èŠå¤©åŠŸèƒ½è¯´æ˜

## åŠŸèƒ½æ¦‚è¿°

ä¸º Claude Code Everywhere æ·»åŠ äº†äº¤äº’å¼èŠå¤©ç•Œé¢ï¼Œå…è®¸ç”¨æˆ·ç›´æ¥ä¸ Claude Agent å¯¹è¯å¹¶å®æ—¶æŸ¥çœ‹æ‰§è¡Œç»“æœã€‚

## å·²å®ç°çš„åŠŸèƒ½

### 1. ç‚¹å‡»è·³è½¬åˆ°èŠå¤©é¡µé¢

- âœ… é¦–é¡µå·¥ä½œç›®å½•å¡ç‰‡æ”¯æŒç‚¹å‡»è·³è½¬
- âœ… ç‚¹å‡»å¡ç‰‡ä¸»ä½“åŒºåŸŸç›´æ¥è¿›å…¥èŠå¤©é¡µé¢
- âœ… æŒ‰é’®æ“ä½œä¸å—å½±å“ï¼ˆè®¾ä¸ºé»˜è®¤ã€ç¼–è¾‘ã€åˆ é™¤ç­‰ï¼‰
- âœ… æ‹–åŠ¨æ‰‹åŠ¿ä¸ä¼šè§¦å‘è·³è½¬

**ä»£ç ä½ç½®**: [public/js/components/DirectoryList.js:601-614](public/js/components/DirectoryList.js#L601-L614)

### 2. èŠå¤©ç•Œé¢

- âœ… ç¾è§‚çš„å¯¹è¯ç•Œé¢ï¼Œæ”¯æŒç”¨æˆ·æ¶ˆæ¯å’Œ AI å“åº”
- âœ… æ˜¾ç¤ºå½“å‰å·¥ä½œç›®å½•ä¿¡æ¯ï¼ˆåˆ«åå’Œè·¯å¾„ï¼‰
- âœ… æ”¯æŒæ–°ä¼šè¯åˆ‡æ¢ï¼ˆå¼€å…³æŒ‰é’®ï¼‰
- âœ… å¤šè¡Œè¾“å…¥æ”¯æŒï¼ˆShift+Enter æ¢è¡Œï¼ŒEnter å‘é€ï¼‰
- âœ… è¿”å›é¦–é¡µæŒ‰é’®

**ä»£ç ä½ç½®**: [public/chat.html](public/chat.html)

### 3. Markdown æ¸²æŸ“æ”¯æŒ

Claude çš„å“åº”æ”¯æŒå®Œæ•´çš„ Markdown æ ¼å¼æ˜¾ç¤ºï¼š

- âœ… æ ‡é¢˜ï¼ˆH1, H2, H3ï¼‰
- âœ… ä»£ç å—å’Œè¡Œå†…ä»£ç 
- âœ… åˆ—è¡¨ï¼ˆæœ‰åºå’Œæ— åºï¼‰
- âœ… å¼•ç”¨å—
- âœ… è¡¨æ ¼
- âœ… é“¾æ¥
- âœ… ä»£ç é«˜äº®èƒŒæ™¯

**å®ç°**: ä½¿ç”¨ [marked.js](https://marked.js.org/) åº“è¿›è¡Œ Markdown è§£æå’Œæ¸²æŸ“

**ä»£ç ä½ç½®**:
- [public/chat.html:13](public/chat.html#L13) - Marked.js å¼•å…¥
- [public/chat.html:163-235](public/chat.html#L163-L235) - Markdown æ ·å¼
- [public/js/chat.js:243-254](public/js/chat.js#L243-L254) - Markdown æ¸²æŸ“é€»è¾‘

### 4. å®æ—¶æµå¼å“åº”

- âœ… ä½¿ç”¨ Server-Sent Events (SSE) å®æ—¶ä¼ è¾“
- âœ… æ‰“å­—æŒ‡ç¤ºå™¨åŠ¨ç”»
- âœ… å¢é‡æ˜¾ç¤º AI å“åº”ï¼ˆé€å­—æ˜¾ç¤ºï¼‰
- âœ… æ”¯æŒå¤šç§æ¶ˆæ¯ç±»å‹ï¼š
  - `assistant_response` - AI å›å¤
  - `status` - çŠ¶æ€æ›´æ–°
  - `result` - ä»»åŠ¡ç»“æœ
  - `error` - é”™è¯¯ä¿¡æ¯

**ä»£ç ä½ç½®**:
- [src/web/routes/chat.ts](src/web/routes/chat.ts) - åç«¯ SSE å®ç°
- [public/js/chat.js:115-172](public/js/chat.js#L115-L172) - å‰ç«¯æµå¼æ¥æ”¶

### 5. ä¼šè¯ç®¡ç†

- âœ… æ”¯æŒç»§ç»­ä¸Šæ¬¡ä¼šè¯
- âœ… æ”¯æŒå¼€å¯æ–°ä¼šè¯ï¼ˆé€šè¿‡åˆ‡æ¢æŒ‰é’®ï¼‰
- âœ… ä¼šè¯çŠ¶æ€åœ¨åŒä¸€å·¥ä½œç›®å½•ä¸‹ä¿æŒ

**ä»£ç ä½ç½®**: [public/chat.html:279-286](public/chat.html#L279-L286)

### 6. JWT è®¤è¯

- âœ… æ‰€æœ‰èŠå¤© API è¯·æ±‚éƒ½ç»è¿‡ JWT è®¤è¯
- âœ… Token ä» localStorage è‡ªåŠ¨è¯»å–
- âœ… æœªç™»å½•è‡ªåŠ¨è·³è½¬åˆ°ç™»å½•é¡µé¢

**ä»£ç ä½ç½®**:
- [public/chat.html:226-232](public/chat.html#L226-L232) - è®¤è¯æ£€æŸ¥
- [public/js/chat.js:56](public/js/chat.js#L56) - API è¯·æ±‚è®¤è¯

## ä½¿ç”¨æ–¹æ³•

### æ–¹å¼ä¸€ï¼šé€šè¿‡é¦–é¡µè·³è½¬

1. è®¿é—® http://127.0.0.1:8000
2. ç™»å½•åæŸ¥çœ‹å·¥ä½œç›®å½•åˆ—è¡¨
3. ç‚¹å‡»ä»»æ„å·¥ä½œç›®å½•å¡ç‰‡
4. è¿›å…¥èŠå¤©ç•Œé¢ï¼Œå¼€å§‹å¯¹è¯

### æ–¹å¼äºŒï¼šç›´æ¥è®¿é—®

è®¿é—® `http://127.0.0.1:8000/chat.html?alias=<ç›®å½•åˆ«å>`

ä¾‹å¦‚ï¼š`http://127.0.0.1:8000/chat.html?alias=my-project`

## API ç«¯ç‚¹

### POST /api/chat/execute

æ‰§è¡Œ Claude Agent ä»»åŠ¡å¹¶è¿”å›æµå¼å“åº”ã€‚

**è¯·æ±‚**:
```json
{
  "alias": "project-alias",
  "prompt": "å¸®æˆ‘æ£€æŸ¥ä»£ç æœ‰æ²¡æœ‰bug",
  "newSession": false
}
```

**å“åº”**: Server-Sent Events (text/event-stream)

```
data: {"type":"assistant_response","text":"è®©æˆ‘æ£€æŸ¥ä¸€ä¸‹ä»£ç ..."}

data: {"type":"status","text":"ğŸ“ æ­£åœ¨åˆ†æä»£ç "}

data: {"type":"result","text":"æ£€æŸ¥å®Œæˆ"}

data: [DONE]
```

**ä»£ç ä½ç½®**: [src/web/routes/chat.ts](src/web/routes/chat.ts)

## æŠ€æœ¯æ ˆ

- **å‰ç«¯**:
  - åŸç”Ÿ JavaScript (ES6+)
  - Tailwind CSS (UI æ¡†æ¶)
  - Marked.js (Markdown æ¸²æŸ“)

- **åç«¯**:
  - Express.js (Web æ¡†æ¶)
  - TypeScript
  - Server-Sent Events (å®æ—¶é€šä¿¡)
  - @anthropic-ai/claude-agent-sdk (AI Agent)

- **è®¤è¯**: JWT Bearer Token

## æµ‹è¯•

### è‡ªåŠ¨åŒ–æµ‹è¯•

```bash
npm test
```

### æ‰‹åŠ¨æµ‹è¯•

å‚è€ƒ [MANUAL_TEST.md](MANUAL_TEST.md) è¿›è¡Œæ‰‹åŠ¨æµ‹è¯•ã€‚

## æ–‡ä»¶ç»“æ„

```
public/
â”œâ”€â”€ chat.html                          # èŠå¤©é¡µé¢ HTML
â”œâ”€â”€ js/
â”‚   â”œâ”€â”€ chat.js                        # èŠå¤©é¡µé¢é€»è¾‘
â”‚   â””â”€â”€ components/
â”‚       â””â”€â”€ DirectoryList.js           # å·¥ä½œç›®å½•åˆ—è¡¨ç»„ä»¶ï¼ˆå«ç‚¹å‡»è·³è½¬ï¼‰

src/
â””â”€â”€ web/
    â”œâ”€â”€ routes/
    â”‚   â””â”€â”€ chat.ts                    # èŠå¤© API è·¯ç”±
    â””â”€â”€ server.ts                      # Web æœåŠ¡å™¨ï¼ˆæ³¨å†ŒèŠå¤©è·¯ç”±ï¼‰
```

## æœªæ¥æ”¹è¿›

- [ ] æ·»åŠ ä»£ç è¯­æ³•é«˜äº®ï¼ˆhighlight.jsï¼‰
- [ ] æ”¯æŒæ¶ˆæ¯ç¼–è¾‘å’Œé‡å‘
- [ ] æ”¯æŒå¯¼å‡ºèŠå¤©è®°å½•
- [ ] æ·»åŠ èŠå¤©å†å²è®°å½•åˆ—è¡¨
- [ ] æ”¯æŒæ–‡ä»¶ä¸Šä¼ å’Œå›¾ç‰‡åˆ†æ
- [ ] æ”¯æŒåœæ­¢æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡
- [ ] æ·»åŠ å¿«æ·å‘½ä»¤ï¼ˆ/help, /clear ç­‰ï¼‰

## å·²çŸ¥é—®é¢˜

æ— 

## æ›´æ–°æ—¥å¿—

### 2026-01-20

- âœ… æ·»åŠ èŠå¤©é¡µé¢ UI
- âœ… å®ç°ç‚¹å‡»è·³è½¬åŠŸèƒ½
- âœ… æ·»åŠ åç«¯èŠå¤© API
- âœ… å®ç° SSE æµå¼å“åº”
- âœ… æ·»åŠ  Markdown æ¸²æŸ“æ”¯æŒ
- âœ… å®Œå–„é”™è¯¯å¤„ç†å’Œç”¨æˆ·ä½“éªŒ
